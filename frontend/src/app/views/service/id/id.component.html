<div class="p-2 w-full h-full mx-auto">
  <!-- Card Section -->
  <div class="flex flex-1 w-full h-full mx-auto">
    <div
      class="w-full h-full bg-white rounded-xl shadow overflow-auto dark:bg-slate-900"
    >
      <!-- Card Section -->
      <div class="px-6 py-4 mx-auto">
        <div class="sticky top-0 bg-white">
          <!-- Card -->
          @defer (when serviceData()) {

          <div class="flex flex-1 justify-between items-center mb-8">
            <div class="flex items-end gap-2">
              <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200">
                {{ serviceData().name }}
              </h2>
            </div>

            <div class="flex items-center gap-2"></div>
          </div>

          <div class="border-b border-gray-200 dark:border-gray-700">
            <div class="border-b border-gray-200 px-4 dark:border-gray-700">
              <nav class="flex space-x-2" aria-label="Tabs" role="tablist">
                <button
                  type="button"
                  class="hs-tab-active:font-semibold hs-tab-active:border-purple-600 hs-tab-active:text-purple-600 py-4 px-1 inline-flex items-center gap-x-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-purple-600 disabled:opacity-50 disabled:pointer-events-none dark:text-gray-400 dark:hover:text-purple-500 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600 active"
                  id="basic-tabs-item-1"
                  data-hs-tab="#configuration"
                  aria-controls="configuration"
                  role="tab"
                >
                  Configuration
                </button>
                <button
                  type="button"
                  class="hs-tab-active:font-semibold hs-tab-active:border-purple-600 hs-tab-active:text-purple-600 py-4 px-1 inline-flex items-center gap-x-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-purple-600 disabled:opacity-50 disabled:pointer-events-none dark:text-gray-400 dark:hover:text-purple-500 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600"
                  id="basic-tabs-item-2"
                  data-hs-tab="#storage"
                  aria-controls="storage"
                  role="tab"
                >
                  Storage
                </button>
                <button
                  type="button"
                  class="hs-tab-active:font-semibold hs-tab-active:border-purple-600 hs-tab-active:text-purple-600 py-4 px-1 inline-flex items-center gap-x-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-purple-600 disabled:opacity-50 disabled:pointer-events-none dark:text-gray-400 dark:hover:text-purple-500 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600"
                  id="basic-tabs-item-3"
                  data-hs-tab="#secrets"
                  aria-controls="secrets"
                  role="tab"
                >
                  Secrets
                </button>
              </nav>
            </div>

            <div class="mt-3 p-4">
              <div
                id="configuration"
                role="tabpanel"
                aria-labelledby="configuration"
              >
                <form [formGroup]="form">
                  <!-- Grid -->
                  <div class="grid sm:grid-cols-12 gap-2 sm:gap-6">
                    <div class="sm:col-span-3">
                      <label
                        for="af-account-full-name"
                        class="inline-block text-sm text-gray-800 mt-2.5 dark:text-gray-200"
                      >
                        Name
                      </label>
                    </div>
                    <!-- End Col -->

                    <div class="sm:col-span-9">
                      <div class="sm:flex">
                        <input
                          id="af-account-email"
                          type="text"
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          formControlName="name"
                        />
                      </div>
                    </div>
                    <!-- End Col -->

                    <div class="sm:col-span-3">
                      <label
                        for="af-account-full-name"
                        class="inline-block text-sm text-gray-800 mt-2.5 dark:text-gray-200"
                      >
                        Version / Tag
                      </label>
                    </div>
                    <!-- End Col -->

                    <div class="sm:col-span-9">
                      <div class="sm:flex gap-2">
                        <select
                          class="py-3 px-4 pe-9 block w-full border-gray-200 rounded-lg text-sm focus:border-purple-500 focus:ring-purple-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400 dark:focus:ring-gray-600"
                        >
                          @for (tag of tags; track $index) {
                          <option value="{{ tag }}">{{ tag }}</option>
                          }
                        </select>

                        <input
                          id="af-account-email"
                          type="text"
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                        />
                      </div>
                    </div>
                    <!-- End Col -->

                    <div class="sm:col-span-3">
                      <label
                        for="af-account-email"
                        class="inline-block text-sm text-gray-800 mt-2.5 dark:text-gray-200"
                      >
                        FQDN
                      </label>
                      <div class="hs-tooltip inline-block">
                        <button type="button" class="hs-tooltip-toggle ml-1">
                          <svg
                            class="inline-block w-3 h-3 text-gray-400 dark:text-gray-600"
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            fill="currentColor"
                            viewBox="0 0 16 16"
                          >
                            <path
                              d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"
                            />
                            <path
                              d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"
                            />
                          </svg>
                        </button>
                        <span
                          class="hs-tooltip-content hs-tooltip-shown:opacity-100 hs-tooltip-shown:visible opacity-0 transition-opacity inline-block absolute invisible w-40 text-center z-10 py-1 px-2 bg-gray-900 text-xs font-medium text-white rounded-md shadow-sm dark:bg-slate-700"
                          role="tooltip"
                        >
                          If you specify
                          <span class="text-settings">https</span>, the
                          application will be accessible only over https. SSL
                          certificate will be generated for you.<br />If you
                          specify <span class="text-settings">www</span>, the
                          application will be redirected (302) from non-www and
                          vice versa.<br /><br />To modify the domain, you must
                          first stop the application.<br /><br /><span
                            class="text-white"
                            >You must set your DNS to point to the server IP in
                            advance.</span
                          >
                        </span>
                      </div>
                    </div>
                    <!-- End Col -->

                    <div class="sm:col-span-9">
                      <input
                        id="af-account-email"
                        type="email"
                        class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                        formControlName="fqdn"
                      />
                    </div>
                    <!-- End Col -->

                    <div class="sm:col-span-3">
                      <label
                        for="af-account-password"
                        class="inline-block text-sm text-gray-800 mt-2.5 dark:text-gray-200"
                      >
                        Exposed port
                      </label>
                    </div>
                    <!-- End Col -->

                    <div class="sm:col-span-9">
                      <div class="space-y-2">
                        <input
                          id="af-account-password"
                          type="number"
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm rounded-lg text-sm focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          formControlName="exposePort"
                        />
                      </div>
                    </div>
                    <!-- End Col -->
                  </div>
                  <!-- End Grid -->

                  <div class="grid grid-flow-row gap-2 px-4">
                    <div class="flex flex-col mt-4">
                      @for (template of templateKeys; track $index) {
                      <div class="flex flex-row my-2 space-x-2 mb-6">
                        <div class="title font-bold pb-3 capitalize">
                          {{ generateName(templates[template]) }}
                        </div>
                        <!-- <ServiceStatus id="{oneService}" /> -->
                      </div>

                      @if (templates[template].environment.length > 0) { @for
                      (variable of templates[template].environment; track
                      $index) { @if (variable.main === template) {
                      <div class="grid grid-cols-2 items-center gap-2">
                        <label class="h-10" for="{{ variable.name }}">
                          {{ variable.label || variable.name }}
                          @if (variable.description) {
                          <!-- <Explainer explanation={variable.description} /> -->
                          <div class="hs-tooltip inline-block">
                            <button
                              type="button"
                              class="hs-tooltip-toggle ml-1"
                            >
                              <svg
                                class="inline-block w-3 h-3 text-gray-400 dark:text-gray-600"
                                xmlns="http://www.w3.org/2000/svg"
                                width="16"
                                height="16"
                                fill="currentColor"
                                viewBox="0 0 16 16"
                              >
                                <path
                                  d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"
                                />
                                <path
                                  d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"
                                />
                              </svg>
                            </button>
                            <span
                              class="hs-tooltip-content hs-tooltip-shown:opacity-100 hs-tooltip-shown:visible opacity-0 transition-opacity inline-block absolute invisible w-40 text-center z-10 py-1 px-2 bg-gray-900 text-xs font-medium text-white rounded-md shadow-sm dark:bg-slate-700"
                              role="tooltip"
                            >
                              {{ variable.description }}
                            </span>
                          </div>
                          }
                        </label>

                        @if (variable.defaultValue === '$$generate_fqdn') {
                        <!-- <CopyPasswordField
                                      disabled
                                      readonly
                                      name={variable.name}
                                      id={variable.name}
                                      value={service.fqdn}
                                      placeholder={variable.placeholder}
                                      required={variable?.required}
                                    /> -->
                        <input
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          value="{{ serviceData().fqdn }}"
                          placeholder="{{ variable.placeholder }}"
                          required="{{ variable?.required }}"
                        />
                        } @else if (variable.defaultValue ===
                        '$$generate_fqdn_slash') {
                        <!-- <CopyPasswordField
                                      disabled
                                      readonly
                                      name={variable.name}
                                      id={variable.name}
                                      value={service.fqdn + '/' || ''}
                                      placeholder={variable.placeholder}
                                      required={variable?.required}
                                    /> -->
                        <input
                          disabled
                          readonly
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          value="{{ serviceData().fqdn + '/' || '' }}"
                          placeholder="{{ variable.placeholder }}"
                          required="{{ variable?.required }}"
                        />
                        } @else if (variable.defaultValue ===
                        '$$generate_domain') {
                        <!-- <CopyPasswordField
                                      disabled
                                      readonly
                                      name={variable.name}
                                      id={variable.name}
                                      value={getDomain(service.fqdn) || ''}
                                      placeholder={variable.placeholder}
                                      required={variable?.required}
                                    /> -->
                        <input
                          disabled
                          readonly
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          value="{{ getDomain(serviceData().fqdn!) || '' }}"
                          placeholder="{{ variable.placeholder }}"
                          required="{{ variable?.required }}"
                        />
                        } @else if (variable.defaultValue ===
                        '$$generate_network') {
                        <!-- <CopyPasswordField
                                      disabled
                                      readonly
                                      name={variable.name}
                                      id={variable.name}
                                      value={service.destinationDocker.network}
                                      placeholder={variable.placeholder}
                                      required={variable?.required}
                                    /> -->
                        <input
                          disabled
                          readonly
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          value="{{ serviceData().destinationDocker?.network }}"
                          placeholder="{{ variable.placeholder }}"
                          required="{{ variable?.required }}"
                        />
                        } @else if (variable.defaultValue === 'true' ||
                        variable.defaultValue === 'false') { @if (variable.value
                        === 'true' || variable.value === 'false' ||
                        variable.value === 'invite_only') {
                        <select
                          class="w-full font-normal"
                          readonly="{isDisabled}"
                          disabled="{isDisabled}"
                          id="{variable.name}"
                          name="{variable.name}"
                          bind:value="{variable.value}"
                          form="saveForm"
                          placeholder="{variable.placeholder}"
                          required="{variable?.required}"
                        >
                          <option value="true">enabled</option>
                          <option value="false">disabled</option>
                          @if
                          (serviceData().type.startsWith('plausibleanalytics')
                          && variable.id == 'config_disable_registration') {
                          <option value="invite_only">invite_only</option>
                          }
                        </select>
                        } @else {
                        <select
                          class="w-full font-normal"
                          readonly="{isDisabled}"
                          disabled="{isDisabled}"
                          id="{variable.name}"
                          name="{variable.name}"
                          bind:value="{variable.defaultValue}"
                          form="saveForm"
                          placeholder="{variable.placeholder}"
                          required="{variable?.required}"
                        >
                          <option value="true">true</option>
                          <option value="false">false</option>
                        </select>
                        } } @else if (variable.defaultValue ===
                        '$$generate_password') {
                        <!-- <CopyPasswordField
                                      isPasswordField
                                      readonly
                                      disabled
                                      name={variable.name}
                                      id={variable.name}
                                      value={variable.value}
                                      placeholder={variable.placeholder}
                                      required={variable?.required}
                                    /> -->

                        <input
                          disabled
                          readonly
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          value="{{ variable.value }}"
                          placeholder="{{ variable.placeholder }}"
                          required="{{ variable?.required }}"
                        />
                        } @else if (variable.type === 'textarea') {
                        <!-- <textarea
                                      class="w-full"
                                      value={variable.value}
                                      readonly={isDisabled}
                                      disabled={isDisabled}
                                      class:resize-none={$status.service.overallStatus === 'healthy'}
                                      rows="5"
                                      name={variable.name}
                                      id={variable.name}
                                      placeholder={variable.placeholder}
                                      required={variable?.required}
                                    /> -->

                        <input
                          disabled
                          readonly
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          value="{{ variable.value }}"
                          placeholder="{{ variable.placeholder }}"
                          required="{{ variable?.required }}"
                        />
                        } @else {
                        <!-- <CopyPasswordField
                                      isPasswordField={variable.id.startsWith('secret')}
                                      required={variable?.required}
                                      readonly={variable.readOnly || isDisabled}
                                      disabled={variable.readOnly || isDisabled}
                                      name={variable.name}
                                      id={variable.name}
                                      value={variable.value}
                                      placeholder={variable.placeholder}
                                    /> -->

                        <input
                          disabled
                          readonly
                          class="py-2 px-3 pr-11 block w-full border-gray-200 shadow-sm text-sm rounded-lg focus:border-purple-500 focus:ring-purple-500 dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400"
                          value="{{ variable.value }}"
                          placeholder="{{ variable.placeholder }}"
                          required="{{ variable?.required }}"
                        />
                        }
                      </div>
                      } } } }
                    </div>
                  </div>

                  <div class="mt-5 flex justify-end gap-x-2">
                    <button
                      type="button"
                      class="py-2 px-3 inline-flex justify-center items-center gap-2 rounded-md border border-transparent font-semibold bg-purple-500 text-white hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all text-sm dark:focus:ring-offset-gray-800"
                    >
                      Save changes
                    </button>
                  </div>
                </form>
              </div>
              <div
                id="storage"
                class="hidden"
                role="tabpanel"
                aria-labelledby="storage"
              >
                <p class="text-gray-500 dark:text-gray-400">
                  This is the
                  <em class="font-semibold text-gray-800 dark:text-gray-200"
                    >second</em
                  >
                  item's tab body.
                </p>
              </div>
              <div
                id="secrets"
                class="hidden"
                role="tabpanel"
                aria-labelledby="secrets"
              >
                <p class="text-gray-500 dark:text-gray-400">
                  This is the
                  <em class="font-semibold text-gray-800 dark:text-gray-200"
                    >third</em
                  >
                  item's tab body.
                </p>
              </div>
            </div>
            <!-- End Card Section -->
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
